<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Insert title here.</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="/css/reset.css" />
        <link rel="stylesheet" href="/css/top-nav.css" />
        <link rel="stylesheet" href="/css/common.css" />
        <link
            rel="stylesheet"
            href="/css/pages/customer-support/business-apply.css"
        />
        <script type="text/javascript" src="/js/components/button.js"></script>
        <script
            type="text/javascript"
            src="/js/components/text-field.js"
        ></script>
        <script
            type="text/javascript"
            src="/js/components/dropdown.js"
        ></script>
        <script
            type="text/javascript"
            src="/js/components/checkbox.js"
        ></script>
        <script type="text/javascript" src="/js/components/top-nav.js"></script>
        <script type="text/javascript" src="/js/components/footer.js"></script>
    </head>
    <body>
        <script>
            let files;
            const uploadFiles = () => {
                let input = document.createElement('input');
                input.type = 'file';
                input.multiple = true;
                input.accept = '.jpg,.png,.pdf,.doc,.docx,.xls,.hwp';
                input.onchange = (_) => {
                    files = Array.from(input.files);
                    render();
                };
                input.click();
            };

            const deleteFile = (index) => {
                files = files.filter((_, i) => i !== index);
                render();
            };

            const render = () => {
                const container = document.querySelector(
                    'div.attachment-container',
                );
                if (files.length === 0) {
                    container.innerHTML = `
                        <div class="attachment-guide" onclick="uploadFiles()">
                            <span class="body-me"> 파일을 업로드 해주세요 </span>
                            <span class="body-me"
                                >(Jpg, Png, PDF, Word, Excel, Hwp) 파일만 업로드
                                해주세요</span
                            >
                            <button-text style_="primary" underline="true"
                                >컴퓨터에서 파일 선택하기</button-text
                            >
                        </div>
                    `;
                    return;
                } else {
                    container.innerHTML = ``;
                }
                files.forEach((file, index) => {
                    const att = document.createElement('div');
                    att.classList.add('attachment-wrapper');
                    const size = file.size / 1000000;
                    att.innerHTML = `
                            <div></div>
                            <div>
                                <span>${file.name}</span>
                                <span>${size.toFixed(2)}mb</span>
                            </div>
                            <div onclick="deleteFile(${index})"></div>
                        `;
                    container.append(att);
                });
            };
        </script>
        <top-nav focus="5"></top-nav>
        <going-up></going-up>
        <div class="content-wrapper">
            <span class="title-bd">신청서 작성하기</span>
            <span class="body-me">사업 공고 명</span>
            <div class="form-container">
                <div>
                    <span class="body-me"><span>* </span>이름</span>
                    <textfield-default
                        placeholder="이름을 입력해주세요."
                        class="neccessary"
                    ></textfield-default>
                </div>
                <div>
                    <span class="body-me"><span>* </span>기업명</span>
                    <textfield-default
                        placeholder="기업명을 입력해주세요."
                        class="neccessary"
                    ></textfield-default>
                </div>
                <div>
                    <span class="body-me"><span>* </span>소속/직위</span>
                    <textfield-default
                        placeholder="소속/직위를 입력해주세요."
                        class="neccessary"
                    ></textfield-default>
                </div>
                <div>
                    <span class="body-me"><span>* </span>이메일</span>
                    <div class="email-wrapper">
                        <textfield-default
                            placeholder="이메일을 입력해주세요."
                            class="neccessary"
                        ></textfield-default>
                        <dropdown-container>
                            <dropdown-header
                                value="@naver.com"
                                type="default"
                            ></dropdown-header>
                            <dropdown-content>
                                <span>@gmail.com</span>
                                <span>@gmail.com</span>
                                <span>@gmail.com</span>
                                <span>@gmail.com</span>
                                <span>@gmail.com</span>
                                <span>@gmail.com</span>
                            </dropdown-content>
                        </dropdown-container>
                    </div>
                </div>
                <div>
                    <span class="body-me"><span>* </span>연락처</span>
                    <div class="phone-wrapper">
                        <dropdown-container>
                            <dropdown-header
                                value="010"
                                type="default"
                            ></dropdown-header>
                            <dropdown-content>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                            </dropdown-content>
                        </dropdown-container>
                        <textfield-default
                            placeholder="중간 번호"
                            class="neccessary"
                        ></textfield-default>
                        <textfield-default
                            class="neccessary"
                            placeholder="끝 번호"
                        ></textfield-default>
                    </div>
                </div>
                <div>
                    <span class="body-me">전화번호</span>
                    <div class="phone-wrapper">
                        <dropdown-container>
                            <dropdown-header
                                value="010"
                                type="default"
                            ></dropdown-header>
                            <dropdown-content>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                                <span>010</span>
                            </dropdown-content>
                        </dropdown-container>
                        <textfield-default
                            placeholder="중간 번호"
                        ></textfield-default>
                        <textfield-default
                            placeholder="끝 번호"
                        ></textfield-default>
                    </div>
                </div>

                <div>
                    <span class="body-me"><span>* </span>첨부파일 업로드</span>
                    <div class="attachment-container">
                        <div class="attachment-guide" onclick="uploadFiles()">
                            <span class="body-me">
                                파일을 업로드 해주세요.
                            </span>
                            <span class="body-me"
                                >(Jpg, Png, PDF, Word, Excel, Hwp) 파일만 업로드
                                해주세요.</span
                            >
                            <button-text style_="primary" underline="true"
                                >컴퓨터에서 파일 선택하기</button-text
                            >
                        </div>
                    </div>
                </div>

                <div class="item-wrapper-row">
                    <checkbox-default size="L"></checkbox-default>
                    <span class="body-me"
                        >개인정보 수집 및 이용에 동의합니다.</span
                    >
                </div>

                <button-default
                    size="xl"
                    style_="secondary"
                    state="disabled"
                    id="submit"
                    >신청하기</button-default
                >
            </div>
        </div>
        <footer-default></footer-default>
        <script>
            const agreeCheck = document.querySelector('checkbox-default');
            const submitButton = document.querySelector('#submit');
            const inputs = [
                ...document.querySelectorAll('textfield-default.neccessary'),
            ];
            const keydownHandler = () => {
                const test = inputs.reduce(
                    (acc, input) => acc && input.getValue() !== '',
                    files.length !== 0 && agreeCheck.checkbox.checked,
                );
                if (test) {
                    submitButton.setAttribute('state', 'default');
                } else {
                    submitButton.setAttribute('state', 'disabled');
                }
            };
            agreeCheck.checkbox.onchange = keydownHandler;
            inputs.forEach((input) => {
                input.addEventListener('keyup', keydownHandler);
            });
        </script>
    </body>
</html>
